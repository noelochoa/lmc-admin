(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[26],{"059c":function(t,e,a){},"392b":function(t,e,a){"use strict";a("4d90"),a("5319");var n,r,i={data(){return{prevRoute:null}},beforeRouteEnter(t,e,a){a((t=>{t.prevRoute=e}))},computed:{today(){const t=new Date,e={month:t.toLocaleDateString("en-US",{month:"long"}),year:t.getFullYear(),dayOfMonth:t.getDate(),dayOfWeek:t.getDay(),human:t.toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric"}),iso:t.toISOString(),yyyymmdd:t.getFullYear()+"-"+(t.getMonth()+1).toString().padStart(2,0)+"-"+t.getDate().toString().padStart(2,"0")};return e},startDayOfMonth(){const t=new Date;return new Date(t.getFullYear(),t.getMonth(),1)},lastDayOfMonth(){const t=new Date;return new Date(t.getFullYear(),t.getMonth()+1,0)}},methods:{replaceAll:function(t,e,a){return t.replace(new RegExp(e,"g"),a)},resolveAssetsUrl:function(t){return"https://localhost:3000/"+t},showNotif:function(t,e){this.$q.notify({color:t?"green-4":"negative",textColor:"white",icon:t?"check_circle_outline":"error_outline",timeout:"2500",position:"top",message:e})},returnToPageIndex:function(t){this.prevRoute&&"/"!==this.prevRoute.path?this.$router.go(-1):this.$router.push(t).catch((t=>{}))},findMaxDt:function(t,e){return new Date(Math.max(new Date(t),new Date(e)))},findMinDt:function(t,e){return new Date(Math.min(new Date(t),new Date(e)))},toQDateFormat:function(t){return t?t.getFullYear()+"/"+(t.getMonth()+1).toString().padStart(2,0)+"/"+t.getDate().toString().padStart(2,0):t},toHumanReadableDt:function(t){const e=new Date(t);return e?e.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})+" "+e.getHours().toString().padStart(2,0)+":"+e.getMinutes().toString().padStart(2,0):t}}},o=i,s=a("2877"),l=Object(s["a"])(o,n,r,!1,null,null,null);e["a"]=l.exports},"411a":function(t,e,a){"use strict";var n=a("059c"),r=a.n(n);r.a},4501:function(t,e,a){"use strict";var n=a("61f0"),r=a.n(n);r.a},"61f0":function(t,e,a){},"8f31":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-page",{staticClass:"q-px-md q-pt-lg"},[a("div",{staticClass:"page-heading text-white q-pa-md"},[a("div",{staticClass:"heading-caption"},[a("h6",[t._v("Feature Product")]),a("br"),a("p",[t._v("\n                Cofigure the following form to feature the product."),a("br"),t._v("\n                NOTE: Uploading an image will replace the existing banner,\n                if applicable.\n            ")])])]),a("div",{staticClass:"page-contents text-white q-pa-md"},[a("div",{staticClass:"content-1"},[a("div",{staticClass:"text-subtitle2 flex flex-center"},[a("q-icon",{staticClass:"caption-icon q-mx-md",attrs:{name:"account_circle"}}),t._v("Product Info\n            ")],1),a("div",[a("q-form",{attrs:{disabled:t.featureProduct.hasError||t.featureProduct.loading},on:{submit:function(e){return e.preventDefault(),e.stopPropagation(),t.onSubmit(e)}}},[t.featureProduct.loading?a("q-item",{staticClass:"q-mt-sm"},[a("q-spinner",{attrs:{color:"white",size:"2em"}})],1):a("q-list",{staticClass:"detail-list",attrs:{separator:""}},[a("q-item",{staticClass:"detail-field"},[a("span",{staticClass:"field-label"},[t._v("Product Name")]),t._v("\n                            "+t._s(t.featureProduct.data.name)+"\n                        ")]),a("q-item",{staticClass:"detail-field"},[a("span",{staticClass:"field-label"},[t._v("Status")]),a("q-toggle",{attrs:{"checked-icon":"check",color:"green-4","unchecked-icon":"clear",label:t.featureProduct.data.isFeatured?"Featured":"Not Featured"},model:{value:t.featureProduct.data.isFeatured,callback:function(e){t.$set(t.featureProduct.data,"isFeatured",e)},expression:"featureProduct.data.isFeatured"}})],1),a("q-item",{staticClass:"detail-field"},[a("span",{staticClass:"field-label"},[t._v("\n                                Banner\n                            ")]),a("div",{staticClass:"field-value"},[a("q-uploader",{ref:"pimgUploader",staticClass:"img-uploader full-width",attrs:{disable:!t.featureProduct.data.isFeatured,square:"","hide-upload-btn":"",accept:"image/jpeg,image/png",label:"Image Upload (Replace)",filter:t._validImage},on:{added:t.imgsAdded,removed:t.imgsRemoved,failed:t.onImgUploadFailed}}),a("br"),null!==t.productBanner&&null===t.selimg?a("div",{staticClass:"flex"},[a("q-img",{attrs:{src:t.resolveAssetsUrl(t.productBanner),ratio:16/9},scopedSlots:t._u([{key:"error",fn:function(){return[a("div",{staticClass:"absolute-full flex flex-center bg-black text-white"},[t._v("\n                                                Cannot load banner image\n                                            ")])]},proxy:!0}],null,!1,5815348)})],1):t._e()],1)])],1),a("q-separator"),a("div",{staticClass:"q-pa-md"},[a("q-btn",{attrs:{label:null!==t.selimg?"Upload and Save":"Save",type:"submit",color:"primary",loading:t.loading,disable:t.loading||t.missingUpload},scopedSlots:t._u([{key:"loading",fn:function(){return[a("q-spinner-gears")]},proxy:!0}])})],1)],1)],1)]),a("div",{staticClass:"content-2"})])])},r=[],i=a("c973"),o=a.n(i),s=a("392b");let l=null;var d={name:"ProductFeature",mixins:[s["a"]],meta(){return{title:"Feature Product"}},beforeCreate(){l=this.$RepositoryFactory.get("products")},created(){this.getProduct()},computed:{productBanner(){const t=this.featureProduct.data.images.find((t=>"banner"==t.imageType));return t?t.image:null},missingUpload(){return!this.productBanner&&null==this.selimg&&this.featureProduct.data.isFeatured}},data(){return{loading:!1,selimg:null,featureProduct:{loading:!0,hasError:!1,data:{name:"",isFeatured:!1,images:[]}}}},methods:{_validImage(t){const e=t.filter((t=>t.size<2097152&&["image/png","image/jpeg"].includes(t.type)));return(!e||e.length<1||e.length<t.length)&&this.showNotif(!1,"Limit image size to 2MB (PNG/JPG)."),e},getProduct(){var t=this;return o()((function*(){try{const e=yield l.getProduct(t.$route.params.id);t.featureProduct.data=e}catch(e){t.showNotif(!1,"Could not retrieve product details. "),t.featureProduct.hasError=!0}finally{t.featureProduct.loading=!1}}))()},onSubmit(){var t=this;return o()((function*(){t.loading=!0;try{if(t.selimg){let e=new FormData;e.append("banner",t.selimg),e.append("imageType","banner"),e.append("isFeatured",t.featureProduct.data.isFeatured),yield l.uploadBanner(t.$route.params.id,e)}else yield l.updateProduct(t.$route.params.id,{isFeatured:t.featureProduct.data.isFeatured});t.showNotif(!0,"Successfully updated feature config."),t.returnToPageIndex("/products")}catch(e){t.showNotif(!1,"Could not update feature config.")}finally{t.loading=!1}}))()},imgsRemoved(t){this.selimg=null},imgsAdded(t){this.selimg=t[0]},onImgUploadFailed:function(t){this.showNotif(!1,"Failed to add your selected image. ")}}},u=d,c=(a("4501"),a("411a"),a("2877")),g=a("9989"),p=a("0016"),f=a("0378"),m=a("66e5"),h=a("0d59"),v=a("1c1c"),b=a("9564"),y=a("ee89"),w=a("068f"),P=a("eb85"),S=a("9c40"),F=a("cf57"),C=a("8572"),D=a("eebe"),q=a.n(D),x=Object(c["a"])(u,n,r,!1,null,"50020a9e",null);e["default"]=x.exports;q()(x,"components",{QPage:g["a"],QIcon:p["a"],QForm:f["a"],QItem:m["a"],QSpinner:h["a"],QList:v["a"],QToggle:b["a"],QUploader:y["a"],QImg:w["a"],QSeparator:P["a"],QBtn:S["a"],QSpinnerGears:F["a"],QField:C["a"]})}}]);