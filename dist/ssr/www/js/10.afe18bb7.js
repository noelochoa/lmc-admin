(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[10],{"392b":function(t,e,a){"use strict";a("4d90"),a("5319");var n,o,r={data(){return{prevRoute:null}},beforeRouteEnter(t,e,a){a((t=>{t.prevRoute=e}))},computed:{today(){const t=new Date,e={month:t.toLocaleDateString("en-US",{month:"long"}),year:t.getFullYear(),dayOfMonth:t.getDate(),dayOfWeek:t.getDay(),human:t.toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric"}),iso:t.toISOString(),yyyymmdd:t.getFullYear()+"-"+(t.getMonth()+1).toString().padStart(2,0)+"-"+t.getDate().toString().padStart(2,"0")};return e},startDayOfMonth(){const t=new Date;return new Date(t.getFullYear(),t.getMonth(),1)},lastDayOfMonth(){const t=new Date;return new Date(t.getFullYear(),t.getMonth()+1,0)}},methods:{replaceAll:function(t,e,a){return t.replace(new RegExp(e,"g"),a)},resolveAssetsUrl:function(t){return"https://api.bake-free.co/"+t},showNotif:function(t,e){this.$q.notify({color:t?"green-4":"negative",textColor:"white",icon:t?"check_circle_outline":"error_outline",timeout:"2500",position:"top",message:e})},returnToPageIndex:function(t){this.prevRoute&&"/"!==this.prevRoute.path?this.$router.go(-1):this.$router.push(t).catch((t=>{}))},findMaxDt:function(t,e){return new Date(Math.max(new Date(t),new Date(e)))},findMinDt:function(t,e){return new Date(Math.min(new Date(t),new Date(e)))},toQDateFormat:function(t){return t?t.getFullYear()+"/"+(t.getMonth()+1).toString().padStart(2,0)+"/"+t.getDate().toString().padStart(2,0):t},toHumanReadableDt:function(t){const e=new Date(t);return e?e.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})+" "+e.getHours().toString().padStart(2,0)+":"+e.getMinutes().toString().padStart(2,0):t}}},s=r,i=a("2877"),l=Object(i["a"])(s,n,o,!1,null,null,null);e["a"]=l.exports},7869:function(t,e,a){"use strict";var n=a("9bfa"),o=a.n(n);o.a},"96ec":function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-dialog",{attrs:{value:t.showDlg,square:""},on:{hide:t.emitClose}},[a("q-card",{attrs:{dark:""}},[a("q-card-section",{staticClass:"row items-center"},[t._t("avatar"),a("span",{staticClass:"q-ml-sm"},[t._t("message")],2)],2),a("q-card-actions",{attrs:{align:"right"}},[t._t("actions")],2)],1)],1)},o=[],r={name:"ConfirmDialog",props:{showDlg:{type:Boolean,required:!0,default:!1}},methods:{emitClose(){this.$emit("update:showDlg",!1)}}},s=r,i=a("2877"),l=a("24e8"),c=a("f09f"),u=a("a370"),d=a("4b7e"),p=a("eebe"),h=a.n(p),g=Object(i["a"])(s,n,o,!1,null,null,null);e["a"]=g.exports;h()(g,"components",{QDialog:l["a"],QCard:c["a"],QCardSection:u["a"],QCardActions:d["a"]})},"97cb":function(t,e,a){},"9bfa":function(t,e,a){},c802:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-page",{staticClass:"q-px-md q-pt-lg"},[a("div",{staticClass:"page-heading text-white q-pa-md"},[a("div",{staticClass:"heading-caption"},[a("h6",[t._v("Product Discount")]),a("br"),a("p",[t._v("\n                The following are product discounts applied in the webstore.\n            ")])]),a("div",{staticClass:"heading-stat-1 text-caption"},[t._v("\n            Today\n            "),a("br"),a("p",{staticClass:"text-subtitle2"},[t._v("\n                "+t._s(t.today.human)+"\n            ")])])]),a("div",{staticClass:"page-contents text-white q-pa-md"},[a("div",{staticClass:"content-1"},[a("q-btn",{staticClass:"q-mr-sm",attrs:{flat:"",round:"",icon:"post_add",to:"/discounts/add"}},[a("q-tooltip",{attrs:{anchor:"bottom right",self:"top middle",offset:[10,10]}},[t._v("Add new entry")])],1),a("q-input",{staticClass:"filter-search-box",attrs:{type:"search",placeholder:"Search discount",debounce:"500",dark:"",dense:"",outlined:""},on:{input:t.searchInput},scopedSlots:t._u([{key:"prepend",fn:function(){return[a("q-icon",{attrs:{name:"search"}})]},proxy:!0},{key:"append",fn:function(){return[a("transition",{attrs:{name:"fade"}},[a("q-icon",{directives:[{name:"show",rawName:"v-show",value:""!=t.search,expression:"search != ''"}],staticClass:"cursor-pointer",attrs:{name:"close"},on:{click:t.searchClear}})],1)]},proxy:!0}]),model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),a("div",{staticClass:"content-2"},[a("q-table",{staticClass:"discounts-table",attrs:{square:"","row-key":"id",data:t.data,columns:t.columns,pagination:t.pagination,"rows-per-page-options":[0],loading:t.loading,filter:t.search,"binary-state-sort":""},on:{"update:pagination":[function(e){t.pagination=e},t.onChgPage],request:t.onRequest},scopedSlots:t._u([{key:"body",fn:function(e){return[a("q-tr",{attrs:{props:e}},[a("q-td",{key:"percent",attrs:{props:e}},[t._v(t._s(e.row.percent))]),a("q-td",{key:"target",staticClass:"capitalize",attrs:{props:e}},[t._v(t._s(e.row.target))]),a("q-td",{key:"start",attrs:{props:e}},[t._v(t._s(e.row.start))]),a("q-td",{key:"end",attrs:{props:e}},[t._v(t._s(e.row.end))]),a("q-td",{key:"count",attrs:{props:e}},[t._v(t._s(e.row.count))]),a("q-td",[a("q-btn",{staticClass:"q-mr-sm",attrs:{dense:"",flat:"",round:"",icon:"build",to:"/discounts/edit/"+e.row.id}},[a("q-tooltip",{attrs:{anchor:"center right",self:"center left",offset:[10,10]}},[t._v("Edit Discount")])],1),a("q-btn",{attrs:{dense:"",flat:"",round:"",icon:"delete"},on:{click:function(a){return t.confirmDel(e.row.id)}}},[a("q-tooltip",{attrs:{anchor:"bottom right",self:"top middle",offset:[10,10]}},[t._v("Delete Discount\n                                ")])],1)],1)],1)]}}])}),a("ConfirmDialog",{attrs:{showDlg:t.showDlg},on:{"update:showDlg":function(e){t.showDlg=e},"update:show-dlg":function(e){t.showDlg=e}},scopedSlots:t._u([{key:"avatar",fn:function(){return[a("q-avatar",{attrs:{icon:"delete_forever",color:"red-5","text-color":"white"}})]},proxy:!0},{key:"message",fn:function(){return[t._v("\n                    Continue on removing this discount?"),a("br"),t._v("\n                    Warning: This action is permanent.\n                ")]},proxy:!0},{key:"actions",fn:function(){return[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Cancel"}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Remove",color:"red-5"},on:{click:t.onRemove}})]},proxy:!0}])})],1)])])},o=[],r=(a("fb6a"),a("5319"),a("c973")),s=a.n(r),i=a("96ec"),l=a("392b");let c=null;var u={name:"DiscountsIndex",components:{ConfirmDialog:i["a"]},mixins:[l["a"]],meta(){return{title:"Product Discounts"}},beforeCreate(){c=this.$RepositoryFactory.get("discounts")},created(){this.$route.query.s&&(this.search=this.$route.query.s),this.$route.query.p&&!isNaN(this.$route.query.p)&&(this.pagination.page=Number.parseInt(this.$route.query.p))},mounted(){this.onRequest({pagination:this.pagination,filter:void 0})},data(){return{discountList:[],search:"",searchReq:null,loading:!1,showDlg:!1,toDelID:-1,pagination:{sortBy:"start",descending:!0,page:1,rowsPerPage:9},columns:[{name:"percent",field:"percent",label:"Discount %",align:"left",required:!0,sortable:!0},{name:"target",field:"target",align:"left",label:"Target Customer",sortable:!0},{name:"start",field:"start",align:"left",label:"Start",sortable:!0},{name:"end",field:"end",align:"left",label:"End",sortable:!0},{name:"count",field:"count",align:"left",label:"No. of Products",sortable:!0},{name:"actions",align:"left",label:"Actions"}],data:[],original:[]}},methods:{searchClear(t){let e=Object.assign({},this.$route.query);delete e.s,this.$router.replace({query:e}).catch((t=>{})),this.search=""},searchInput(t){let e=Object.assign({},this.$route.query,{s:t});t||delete e.s,this.$router.replace({query:e}).catch((t=>{}))},onChgPage(t){let e=Object.assign({},this.$route.query,{p:t.page});t||delete e.p,this.$router.replace({query:e}).catch((t=>{}))},onRequest(t){var e=this;return s()((function*(){e.loading=!0;try{const t=yield c.getAllDiscounts();e.original=t,e.data=e.original.slice()}catch(t){e.showNotif(!1,"Could not retrieve discounts. ")}finally{e.loading=!1}}))()},onRemove(){var t=this;return s()((function*(){if(-1!==t.toDelID)try{yield c.deleteDiscount(t.toDelID);t.showNotif(!0,"Successfully removed discount entry."),t.$delete(t.data,t.data.findIndex((e=>e.id==t.toDelID))),t.toDelID=-1}catch(e){t.showNotif(!1,"Could not delete item. ")}}))()},confirmDel(t){this.showDlg=!0,this.toDelID=t}}},d=u,p=(a("dd6f"),a("7869"),a("2877")),h=a("9989"),g=a("9c40"),f=a("05c0"),m=a("27f9"),D=a("0016"),y=a("eaac"),b=a("bd08"),v=a("db86"),w=a("cb32"),q=a("7f67"),C=a("eebe"),_=a.n(C),S=Object(p["a"])(d,n,o,!1,null,"1d741fc2",null);e["default"]=S.exports;_()(S,"components",{QPage:h["a"],QBtn:g["a"],QTooltip:f["a"],QInput:m["a"],QIcon:D["a"],QTable:y["a"],QTr:b["a"],QTd:v["a"],QAvatar:w["a"]}),_()(S,"directives",{ClosePopup:q["a"]})},dd6f:function(t,e,a){"use strict";var n=a("97cb"),o=a.n(n);o.a}}]);