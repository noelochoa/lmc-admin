(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[24],{"06d8":function(t,e,a){},"1d9d":function(t,e,a){"use strict";var s=a("06d8"),r=a.n(s);r.a},"392b":function(t,e,a){"use strict";a("4d90"),a("5319");var s,r,i={data(){return{prevRoute:null}},beforeRouteEnter(t,e,a){a((t=>{t.prevRoute=e}))},computed:{today(){const t=new Date,e={month:t.toLocaleDateString("en-US",{month:"long"}),year:t.getFullYear(),dayOfMonth:t.getDate(),dayOfWeek:t.getDay(),human:t.toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric"}),iso:t.toISOString(),yyyymmdd:t.getFullYear()+"-"+(t.getMonth()+1).toString().padStart(2,0)+"-"+t.getDate().toString().padStart(2,"0")};return e},startDayOfMonth(){const t=new Date;return new Date(t.getFullYear(),t.getMonth(),1)},lastDayOfMonth(){const t=new Date;return new Date(t.getFullYear(),t.getMonth()+1,0)}},methods:{replaceAll:function(t,e,a){return t.replace(new RegExp(e,"g"),a)},resolveAssetsUrl:function(t){return"https://api.bake-free.co/"+t},showNotif:function(t,e){this.$q.notify({color:t?"green-4":"negative",textColor:"white",icon:t?"check_circle_outline":"error_outline",timeout:"2500",position:"top",message:e})},returnToPageIndex:function(t){this.prevRoute&&"/"!==this.prevRoute.path?this.$router.go(-1):this.$router.push(t).catch((t=>{}))},findMaxDt:function(t,e){return new Date(Math.max(new Date(t),new Date(e)))},findMinDt:function(t,e){return new Date(Math.min(new Date(t),new Date(e)))},toQDateFormat:function(t){return t?t.getFullYear()+"/"+(t.getMonth()+1).toString().padStart(2,0)+"/"+t.getDate().toString().padStart(2,0):t},toHumanReadableDt:function(t){const e=new Date(t);return e?e.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})+" "+e.getHours().toString().padStart(2,0)+":"+e.getMinutes().toString().padStart(2,0):t}}},o=i,n=a("2877"),d=Object(n["a"])(o,s,r,!1,null,null,null);e["a"]=d.exports},"747d":function(t,e,a){},"8e88":function(t,e,a){"use strict";var s=a("747d"),r=a.n(s);r.a},ab29:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-page",{staticClass:"q-px-md q-pt-lg"},[a("div",{staticClass:"page-heading text-white q-pa-md"},[a("div",{staticClass:"heading-caption"},[a("h6",[t._v("Order Invoice")]),a("br"),a("q-btn",{staticClass:"print-btn q-py-xs q-px-sm",attrs:{dense:"","no-caps":"",color:"primary",icon:"print",label:"Print Invoice"},on:{click:function(e){return t.printWindow()}}})],1)]),a("div",{staticClass:"page-contents text-white q-pa-md"},[a("div",{staticClass:"content-1"},[a("div",{staticClass:"text-subtitle2 flex flex-center"},[a("q-icon",{staticClass:"caption-icon q-mx-md",attrs:{name:"info"}}),t._v("Order#\n                "+t._s(t.order.data.ordernum)+" placed\n                "),t.order.data.created?a("span",[t._v(t._s(t.toHumanReadableDt(t.order.data.created)))]):t._e()],1),a("div",[a("q-form",{attrs:{disabled:t.order.hasError||t.order.loading||t.isReplacedStatus},on:{submit:function(e){return e.preventDefault(),e.stopPropagation(),t.onSubmit(e)}}},[t.order.loading?a("q-item",{staticClass:"q-mt-sm"},[a("q-spinner",{attrs:{color:"white",size:"2em"}})],1):a("q-list",{staticClass:"detail-list",attrs:{separator:""}},[a("q-item",{staticClass:"detail-field"},[a("span",{staticClass:"field-label"},[t._v("Status")]),a("q-select",{staticClass:"field-value",attrs:{options:t.orderStatusList,readonly:"",dark:"",dense:"",outlined:"","hide-bottom-space":"","hide-dropdown-icon":"","emit-value":"","map-options":""},model:{value:t.order.data.status,callback:function(e){t.$set(t.order.data,"status",e)},expression:"order.data.status"}})],1),t.isReplacedStatus?a("q-item",{staticClass:"detail-field"},[a("span",{staticClass:"field-label"},[t._v("Replaced by:")]),t._v("\n                            "+t._s(t.order.data.replacedBy.ordernum)+"\n                        ")]):t._e(),a("q-item",{staticClass:"detail-field"},[a("span",{staticClass:"field-label"},[t._v("Target Date")]),a("q-input",{staticClass:"field-value",attrs:{dense:"",outlined:"","hide-bottom-space":"",dark:"",readonly:""},model:{value:t.order.data.target,callback:function(e){t.$set(t.order.data,"target",e)},expression:"order.data.target"}})],1),a("q-item",{staticClass:"detail-field"},[a("span",{staticClass:"field-label"},[t._v("Delivery Type")]),a("q-select",{staticClass:"field-value",attrs:{options:t.deliveryTypes,dark:"",dense:"",outlined:"",readonly:"","hide-bottom-space":"","hide-dropdown-icon":"","emit-value":"","map-options":""},model:{value:t.order.data.type,callback:function(e){t.$set(t.order.data,"type",e)},expression:"order.data.type"}})],1),a("transition",{attrs:{name:"fade"}},["delivery"==t.order.data.type?a("q-item",{staticClass:"detail-field"},[a("span",{staticClass:"field-label"},[t._v("Address")]),a("q-input",{staticClass:"field-value",attrs:{dense:"",type:"textarea",rows:3,textarea:"",outlined:"",dark:"",readonly:"","hide-bottom-space":""},model:{value:t.order.data.address,callback:function(e){t.$set(t.order.data,"address",e)},expression:"order.data.address"}})],1):t._e()],1),a("q-item",{staticClass:"detail-field"},[a("span",{staticClass:"field-label"},[t._v("\n                                Memo\n                            ")]),a("q-input",{staticClass:"field-value",attrs:{type:"textarea",rows:3,textarea:"",dense:"",readonly:"",outlined:"",dark:"","hide-bottom-space":""},model:{value:t.order.data.memo,callback:function(e){t.$set(t.order.data,"memo",e)},expression:"order.data.memo"}})],1),a("q-item",{staticClass:"detail-field",class:{"cursor-not-allowed bg-grey-8":!t.confirmEditProduct}},[a("span",{staticClass:"field-label"},[t._v("Customer")]),a("q-select",{staticClass:"field-value customer-select",class:{"no-pointer-events":!t.confirmEditProduct},attrs:{disabled:!t.confirmEditProduct,options:t.options,"hide-dropdown-icon":"","hide-bottom-space":"",dark:"",dense:"",readonly:"","options-dense":"",outlined:"","emit-value":"","map-options":""},scopedSlots:t._u([{key:"no-option",fn:function(){return[a("q-item",[a("q-item-section",{staticClass:"text-italic text-grey"},[t._v("\n                                            No customer account found.\n                                        ")])],1)]},proxy:!0}]),model:{value:t.order.data.customer,callback:function(e){t.$set(t.order.data,"customer",e)},expression:"order.data.customer"}})],1),a("q-item",{staticClass:"detail-field product-field",class:{"cursor-not-allowed bg-grey-8":!t.confirmEditProduct}},[a("span",{staticClass:"field-label"},[t._v("\n                                Products\n                            ")]),a("div",{staticClass:"product-details q-py-sm"},t._l(t.order.data.products,(function(e,s){return a("q-item",{key:"product-"+s,staticClass:"product-item"},[a("q-item-section",{attrs:{side:""}},[a("q-avatar",{attrs:{rounded:"",size:"64px"}},[a("img",{attrs:{src:e.image?t.resolveAssetsUrl(e.image):"https://dummyimage.com/64x64/363636/ffffff.png&text=No+Img"}}),a("q-badge",{staticClass:"q-pt-xs",attrs:{floating:"",color:"teal"}},[t._v("\n                                                "+t._s(e.quantity)+"\n                                            ")])],1)],1),a("q-item-section",[a("q-item-label",{staticClass:"product-name"},[t._v("\n                                            "+t._s(e.name)+"\n                                        ")]),a("q-item-label",{staticClass:"text-grey-4 product-name",attrs:{caption:""}},t._l(e.options,(function(e){return a("span",{key:"key-"+e._option},[t._v("\n                                                "+t._s(e._option+": "+e._selected)+"\n                                                "),null!=e.otherValue?a("span",[t._v("("+t._s(e.otherValue)+") ")]):t._e(),a("br")])})),0)],1),a("q-item-section",{staticClass:"text-white",attrs:{side:""}},[e.discount>0?a("span",[a("span",{staticClass:"text-strike"},[t._v("\n                                                "+t._s(e.price)+"\n                                            ")]),t._v("\n                                            (-"+t._s(e.discount)+"%)"),a("br"),t._v("\n                                            "+t._s(e.finalPrice)+" PHP\n                                        ")]):a("span",[t._v(t._s(e.price)+" PHP\n                                        ")])])],1)})),1)]),a("q-item",{staticClass:"detail-field"},[a("span",{staticClass:"field-label"},[t._v("Total Price")]),t._v("\n                            "+t._s(t.orderTotalPrice)+" PHP\n                        ")])],1),a("q-separator"),a("div",{staticClass:"q-pa-md"})],1)],1)]),a("div",{staticClass:"content-2"})])])},r=[],i=(a("c975"),a("fb6a"),a("498a"),a("ded3")),o=a.n(i),n=a("c973"),d=a.n(n),c=a("392b");let l=null,u=null,p=null;var m={name:"OrderInvoice",mixins:[c["a"]],watch:{$route(t,e){t.path!==e.path&&this.getOrderDetails()}},meta(){return{title:"Order Invoice"}},beforeCreate(){l=this.$RepositoryFactory.get("accounts"),u=this.$RepositoryFactory.get("products"),p=this.$RepositoryFactory.get("orders")},created(){this.getOrderStatuses(),this.getAccounts()},mounted(){this.getOrderDetails()},computed:{isReplacedStatus(){return!(!this.orderStatuses||this.orderStatuses.length<1)&&this.orderStatuses.some((t=>t.value==this.order.data.status&&"replaced"==t.label.toLowerCase()))},orderStatusList(){return this.isReplacedStatus?this.orderStatuses:this.orderStatuses.filter((t=>"replaced"!==t.label.toLowerCase()))},orderTotalPrice(){return this.order.data.products.length>0?this.order.data.products.reduce(((t,e)=>t+Number.parseInt(e.finalPrice?e.finalPrice:e.price)),0):0},similarOrderList(){return this.findingSimilar||this.similarOrders&&this.similarOrders.length<1?[]:this.similarOrders}},data(){return{right:!1,loading:!1,pfilterLoading:!1,findingSimilar:!1,showPicker:!1,confirmEditProduct:!1,order:{loading:!0,hasError:!1,data:{ordernum:"",products:[],total:0,customer:null,target:null,address:"",type:"delivery",status:null}},orderBackup:{},orderStatuses:[],deliveryTypes:[{label:"For Delivery",value:"delivery"},{label:"For Pickup",value:"pickup"}],customerList:[],options:null,productOptions:null,searchProduct:null,selectProduct:null,customizedProduct:{id:-1,name:"",image:"",quantity:0,price:0,discounts:[],options:[],otherVal:[]},similarOrders:[]}},methods:{_isValidStatus(t){if(!(this.order.data.status&&this.orderStatuses&&this.orderStatuses.length>0))return"Invalid status selected";const e=this.orderStatuses.find((t=>t.value===this.order.data.status));return!!e||"Invalid status selected"},_isValidType(t){if(!(this.order.data.type&&this.deliveryTypes&&this.deliveryTypes.length>0))return"Invalid type selected";const e=this.deliveryTypes.find((t=>t.value===this.order.data.type));return!!e||"Invalid type selected"},_isValidDatetime(t){const e=/^\d{4}-(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01]) (0?[0-9]|1[0-9]|2[0-3]):([0-9]|[0-5][0-9])$/g;return e.test(t)||"Invalid date & time format"},filterFn(t,e,a){t&&""!=t.trim()?e((()=>{const e=t.toLowerCase();this.options=this.customerList.filter((t=>t.label.toLowerCase().indexOf(e)>-1))})):a()},pfilterFn(t,e,a){var s=this;return d()((function*(){if(t&&""!=t.trim())try{s.pfilterLoading=!0;const a=yield u.searchProducts(t);s.productList=a.products.slice(),e((()=>{s.productOptions=s.productList.map((t=>({label:t.name,value:t.id})))}))}catch(r){s.showNotif(!1,"Error searching product/s."+r)}finally{s.pfilterLoading=!1}else a()}))()},onCloseDialog(){},finalizePrice(){const t=this.customerList.find((t=>t.value==this.order.data.customer));t&&this.order.data.products.forEach((e=>{const a=e.discounts.filter((e=>e.target==t.type||"all"==e.target));if(a&&a.length>0){const t=Math.max.apply(Math,a.map((function(t){return t.percent}))),s=(e.price-e.price*t/100).toFixed(0);e.discount=t,e.finalPrice=s}}))},onSelCustomer(t){this.finalizePrice()},onSelectProduct(t){this.selectProduct=this.productList.find((e=>e.id==t)),this.clearSelection(),this.customizedProduct.id=this.selectProduct.id,this.customizedProduct.name=this.selectProduct.name,this.customizedProduct.image=this.selectProduct.images&&this.selectProduct.images.length>0?this.selectProduct.images[0].image:null,this.customizedProduct.quantity=this.selectProduct.minOrderQuantity,this.customizedProduct.discounts=this.selectProduct.discount,this.calcCustomizationPrice()},removeProduct(t){this.$delete(this.order.data.products,t)},openProductPicker(t){this.selectProduct=null,this.searchProduct=null,this.showPicker=!0},clearSelection(){this.customizedProduct.id=-1,this.customizedProduct.name="",this.customizedProduct.image="",this.customizedProduct.options=[],this.customizedProduct.discounts=[],this.customizedProduct.otherVal=[],this.customizedProduct.quantity=0,this.customizedProduct.price=0},clearSelCustomer(){this.order.data.customer=null,this.order.data.products.forEach((t=>{t.discount=0,t.finalPrice=t.price}))},onChgQty(t){this.calcCustomizationPrice()},onSelOption(t){this.calcCustomizationPrice()},calcCustomizationPrice(){const t=(t,e)=>t+e.value.price;this.customizedProduct.price=this.customizedProduct.quantity*this.customizedProduct.options.reduce(t,this.selectProduct.basePrice)},toSelOptions(t,e){return e?e.map((e=>({label:e.value+(e.price>=0?`(+${e.price}  PHP)`:`(${e.price} PHP)`),value:e,key:t}))):e},getOrderDetails(){var t=this;return d()((function*(){try{t.order.loading=!0;const e=yield p.getOrder(t.$route.params.id);t.order.data=o()({},e),t.orderBackup.customer=e.customer,t.orderBackup.products=e.products.slice()}catch(e){t.showNotif(!1,"Could not retrieve order details. "),t.order.hasError=!0}finally{t.order.loading=!1}}))()},getAccounts(){var t=this;return d()((function*(){l.getAccountSelection().then((e=>{t.customerList=e.slice(),t.options=e.slice()})).catch((e=>{t.customerList=[]}))}))()},getOrderStatuses(){var t=this;return d()((function*(){p.getStatusSelection().then((e=>{t.orderStatuses=e})).catch((e=>{t.orderStatuses=[]}))}))()},printWindow(){window.print()}}},h=m,f=(a("1d9d"),a("8e88"),a("2877")),g=a("9989"),v=a("9c40"),y=a("0016"),P=a("0378"),b=a("66e5"),C=a("0d59"),S=a("1c1c"),_=a("ddd8"),q=a("27f9"),w=a("4074"),x=a("cb32"),D=a("58a81"),k=a("0170"),O=a("eb85"),z=a("8572"),L=a("7ff0"),Q=a("e359"),$=a("9404"),I=a("09e3"),F=a("eebe"),R=a.n(F),M=Object(f["a"])(h,s,r,!1,null,"4083c3f4",null);e["default"]=M.exports;R()(M,"components",{QPage:g["a"],QBtn:v["a"],QIcon:y["a"],QForm:P["a"],QItem:b["a"],QSpinner:C["a"],QList:S["a"],QSelect:_["a"],QInput:q["a"],QItemSection:w["a"],QAvatar:x["a"],QBadge:D["a"],QItemLabel:k["a"],QSeparator:O["a"],QField:z["a"],QFooter:L["a"],QHeader:Q["a"],QDrawer:$["a"],QPageContainer:I["a"]})}}]);